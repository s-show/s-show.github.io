<!doctype html><html class=position-relative itemscope itemtype=http://schema.org/WebPage lang=ja data-bs-theme=dark data-palette=indigo>
<head><script src=https://s-show.github.io/assets/init/bundle.min.4e0393749316f2ca60d3692b603476a26e95d78437f2763585f7a97d94b04f54.js integrity="sha256-TgOTdJMW8spg02krYDR2om6V14Q38nY1hfepfZSwT1Q=" crossorigin=anonymous></script>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>AutoHotKeyの解説と自分の設定について - 閑古鳥ブログ</title>
<link rel=icon href="https://s-show.github.io/images/icons/icon-16x16.png?version=bc881cf71418802eab46d38df006b6f0" sizes=16x16>
<link rel=icon href="https://s-show.github.io/images/icons/icon-32x32.png?version=c2740df8b4aa429981718fd3b63dc468" sizes=32x32>
<link rel=apple-touch-icon href=https://s-show.github.io/favicon_huc1d2ba7c7d6d5aa3e01f2f328b911c53_11507_180x180_resize_box_3.png sizes=180x180 type=image/png>
<link rel=icon href=https://s-show.github.io/favicon_huc1d2ba7c7d6d5aa3e01f2f328b911c53_11507_150x150_resize_box_3.png sizes=150x150 type=image/png>
<link rel=icon href="https://s-show.github.io/images/icons/icon-192x192.png?version=314faa3d71d23e1cf545f1280bd01e37" sizes=192x192>
<link rel=mask-icon href=https://s-show.github.io/safari-pinned-tab.svg color=#6f42c1><link rel=icon href="https://s-show.github.io/images/icons/favicon.ico?version=b21aa710a837168f4ddf45779e92164c">
<meta name=keywords content>
<meta name=description content="前置き# 自作キーボードキットのErgoDashを組み立てて日々使っているが、以下のページで紹介されている方法を使って、Raise/Lower">
<meta name=robots content="index, follow"><meta name=twitter:card content="summary">
<meta name=twitter:title content="AutoHotKeyの解説と自分の設定について">
<meta name=twitter:description content="前置き# 自作キーボードキットのErgoDashを組み立てて日々使っているが、以下のページで紹介されている方法を使って、Raise/Lower">
<meta name=twitter:site content="@s_show_0000">
<meta property="og:title" content="AutoHotKeyの解説と自分の設定について">
<meta property="og:description" content="前置き# 自作キーボードキットのErgoDashを組み立てて日々使っているが、以下のページで紹介されている方法を使って、Raise/Lower">
<meta property="og:type" content="article">
<meta property="og:url" content="https://s-show.github.io/posts/2019-06-18/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2019-06-18T11:35:06+00:00">
<meta property="article:modified_time" content="2019-06-18T11:35:06+00:00">
<meta itemprop=name content="AutoHotKeyの解説と自分の設定について">
<meta itemprop=description content="前置き# 自作キーボードキットのErgoDashを組み立てて日々使っているが、以下のページで紹介されている方法を使って、Raise/Lower"><meta itemprop=datePublished content="2019-06-18T11:35:06+00:00">
<meta itemprop=dateModified content="2019-06-18T11:35:06+00:00">
<meta itemprop=wordCount content="10889">
<meta itemprop=keywords content="プログラミング,備忘録,">
<link data-precache rel=stylesheet href="https://s-show.github.io/assets/main/bundle.min.2f97cee03d63ba6cb667a87b185956f903bdc36c9ed2a8ff0dbac7c574a40975.css" integrity="sha256-L5fO4D1jumy2Z6h7GFlW+QO9w2ye0qj/DbrHxXSkCXU=" crossorigin=anonymous>
<link data-precache rel=stylesheet href=https://s-show.github.io/assets/viewer/bundle.min.6d0fc65b8b058ac563091dc5c36f61afba5dd705058680aa24f1d5a3bcf0064d.css integrity="sha256-bQ/GW4sFisVjCR3Fw29hr7pd1wUFhoCqJPHVo7zwBk0=" crossorigin=anonymous>
</head>
<body><header>
<nav class="top-app-bar shadow navbar navbar-expand-lg fixed-top">
<div class=container>
<a class="navbar-brand d-flex align-items-center flex-grow-1 flex-lg-grow-0 text-lg-start ms-2 ms-lg-0 mx-auto me-lg-2" href=https://s-show.github.io/>閑古鳥ブログ
</a>
<button class="navbar-toggler order-5" type=button data-bs-toggle=offcanvas data-bs-target=#navbarMenus aria-controls=navbarMenus aria-expanded=false aria-label="Toggle navigation">
<i class="fas fa-ellipsis-h"></i>
</button>
<div class="offcanvas-lg offcanvas-end flex-grow-1" data-bs-scroll=true tabindex=-1 id=navbarMenus aria-labelledby=navbarMenusLabel>
<div class="offcanvas-header px-4 pb-0">
<h5 class=offcanvas-title id=navbarMenusLabel>閑古鳥ブログ</h5>
<button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas data-bs-target=#navbarMenus aria-label=Close></button>
</div>
<div class="offcanvas-body p-4 pt-0 p-lg-0">
<hr class=d-lg-none>
<ul class="navbar-nav flex-row flex-wrap align-items-center me-auto">
</ul>
<hr class=d-lg-none>
<form class="search-bar ms-auto my-1" action=https://s-show.github.io/search/ novalidate>
<div class="input-group input-group-sm align-items-center">
<span class="btn btn-search disabled position-absolute left-0 border-0">
<i class="fas fa-fw fa-search fa-lg"></i>
</span>
<input class="py-2 form-control rounded search-input" name=q type=search aria-label=Search required>
</div>
</form><hr class=d-lg-none>
<ul class="navbar-nav flex-row flex-wrap align-items-center ms-md-auto">
<li class="nav-item dropdown col-6 col-lg-auto">
<a class="nav-link px-0 py-2 px-lg-1" href=# id=fontSizeDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
<i class="fas fa-fw fa-font"></i>
<span class=d-lg-none>フォントサイズ</span>
</a>
<ul class="dropdown-menu dropdown-menu-end" aria-labelledby=fontSizeDropdown>
<li>
<button class="font-size-item dropdown-item" data-size=xs>
極小
</button>
</li>
<li>
<button class="font-size-item dropdown-item" data-size=sm>
小
</button>
</li>
<li>
<button class="font-size-item dropdown-item active" data-size=md>
標準
</button>
</li>
<li>
<button class="font-size-item dropdown-item" data-size=lg>
大
</button>
</li>
<li>
<button class="font-size-item dropdown-item" data-size=xl>
特大
</button>
</li>
</ul>
</li>
<li class="nav-item dropdown col-6 col-lg-auto">
<a class="nav-link px-0 py-2 px-lg-1" href=# id=paletteDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
<i class="fas fa-fw fa-palette"></i>
<span class=d-lg-none>パレット</span>
</a>
<ul class="dropdown-menu dropdown-menu-end px-2" aria-labelledby=paletteDropdown>
<div class=row>
<li class="col-4 my-1">
<a role=button id=palette-blue aria-label=Blue class="btn btn-sm w-100 palette text-bg-blue" data-palette=blue>
</a>
</li>
<li class="col-4 my-1">
<a role=button id=palette-blue-gray aria-label="Blue Gray" class="btn btn-sm w-100 palette text-bg-blue-gray" data-palette=blue-gray>
</a>
</li>
<li class="col-4 my-1">
<a role=button id=palette-brown aria-label=Brown class="btn btn-sm w-100 palette text-bg-brown" data-palette=brown>
</a>
</li>
<li class="col-4 my-1">
<a role=button id=palette-cyan aria-label=Cyan class="btn btn-sm w-100 palette text-bg-cyan" data-palette=cyan>
</a>
</li>
<li class="col-4 my-1">
<a role=button id=palette-green aria-label=Green class="btn btn-sm w-100 palette text-bg-green" data-palette=green>
</a>
</li>
<li class="col-4 my-1">
<a role=button id=palette-indigo aria-label=Indigo class="btn btn-sm w-100 palette text-bg-indigo" data-palette=indigo>
</a>
</li>
<li class="col-4 my-1">
<a role=button id=palette-orange aria-label=Orange class="btn btn-sm w-100 palette text-bg-orange" data-palette=orange>
</a>
</li>
<li class="col-4 my-1">
<a role=button id=palette-pink aria-label=Pink class="btn btn-sm w-100 palette text-bg-pink" data-palette=pink>
</a>
</li>
<li class="col-4 my-1">
<a role=button id=palette-purple aria-label=Purple class="btn btn-sm w-100 palette text-bg-purple" data-palette=purple>
</a>
</li>
<li class="col-4 my-1">
<a role=button id=palette-red aria-label=Red class="btn btn-sm w-100 palette text-bg-red" data-palette=red>
</a>
</li>
<li class="col-4 my-1">
<a role=button id=palette-teal aria-label=Teal class="btn btn-sm w-100 palette text-bg-teal" data-palette=teal>
</a>
</li>
<li class="col-4 my-1">
<a role=button id=palette-yellow aria-label=Yellow class="btn btn-sm w-100 palette text-bg-yellow" data-palette=yellow>
</a>
</li>
</div>
</ul>
</li>
<li class="nav-item dropdown col-6 col-lg-auto">
<a class="nav-link px-0 py-2 px-lg-1" href=# id=modeDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
<i class="mode-icon fas fa-fw fa-moon" id=modeIcon></i>
<span class=d-lg-none>表示モード</span>
</a>
<ul class="dropdown-menu dropdown-menu-end" aria-labelledby=modeDropdown>
<li class=mode-item data-color-mode=light data-icon=sun>
<button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-sun"></i> Light
</button>
</li>
<li class="mode-item active" data-color-mode=dark data-icon=moon>
<button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-moon"></i> Dark
</button>
</li>
<li class=mode-item data-color-mode=auto data-icon=adjust>
<button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-adjust"></i> Auto
</button>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</nav>
</header>
<main class=container>
<div class="row content"><noscript>
<div class="alert alert-danger" role=alert>あなたのブラウザはJavascriptをサポートしていません。</div>
</noscript>
<aside class="col-lg-4 sidebar d-flex order-lg-5">
<div class="container d-flex flex-column">
<div class="accordion profile">
<div class="accordion-item card row text-center component">
<div class="accordion-header card-header border-0" id=profile-header>
<a class="accordion-button d-lg-none mb-2 collapsed shadow-none p-0 bg-transparent text-surface" type=button data-bs-toggle=collapse data-bs-target=#profile aria-expanded=false aria-controls=profile>
プロフィール
</a>
</div>
<div class="card-body collapse accordion-collapse accordion-body d-lg-block" id=profile aria-labelledby=profile-header>
<div class="col-12 d-flex align-items-center justify-content-center"><picture><img class="profile-avatar rounded-circle" alt=s-show src=https://s-show.github.io/img/profileIcon.png loading=lazy data-viewer-invisible width=500 height=500>
</picture></div>
<div class="col-12 profile-meta"><div class="profile-name fw-fold fs-lg">s-show</div><div class=profile-bio>プログラミングや3Dプリンタやキーボードなどが好きな平凡な公務員</div><div class=profile-location><i class="fas fa-fw fa-map-marker-alt"></i>Japan</div><div class="profile-about text-primary"><i class="fas fa-fw fa-user"></i><a href=https://s-show.github.io/about/>About</a></div><div class="profile-contact text-primary"><i class="fas fa-fw fa-question-circle"></i><a href=https://s-show.github.io/contact/>Contact Us</a></div></div>
<nav class="social-links nav justify-content-center mt-1 justify-content-around">
<a class="nav-link social-link" href=mailto:kankodori.blog@gmail.com title=Email>
<i class="fas fa-fw fa-2x fa-envelope"></i>
</a>
<a class="nav-link social-link" target=_blank href=https://github.com/s-show title=GitHub rel="noopener noreferrer">
<i class="fa-fw fa-2x fab fa-github"></i>
</a>
<a class="nav-link social-link" target=_blank href=https://twitter.com/s_show_0000 title=Twitter rel="noopener noreferrer">
<i class="fa-fw fa-2x fab fa-twitter"></i>
</a>
<a class="nav-link social-link" target=_blank href=https://s-show.github.io/index.xml title=RSS rel="noopener noreferrer">
<i class="fas fa-fw fa-2x fa-rss"></i>
</a>
</nav>
</div>
</div>
</div>
<div class="accordion taxonomies-toggle">
<section class="row card component accordion-item">
<div class="accordion-header card-header border-0">
<a class="accordion-button d-lg-none mb-1 collapsed shadow-none p-0 bg-transparent" type=button data-bs-toggle=collapse data-bs-target=#taxonomies-toggle aria-expanded=false aria-controls=taxonomies-toggle>
分類
</a>
</div>
<div class="card-body collapse accordion-collapse accordion-body d-lg-block" id=taxonomies-toggle>
<ul class="nav nav-pills nav-fill" id=myTab role=tablist>
<li class=nav-item role=presentation>
<button class="nav-link active" id=taxonomyTagsTab data-bs-toggle=tab data-bs-target=#taxonomyTags type=button role=tab aria-controls=タグ aria-selected=true>
タグ
</button>
</li>
<li class=nav-item role=presentation>
<button class=nav-link id=taxonomyArchivesTab data-bs-toggle=tab data-bs-target=#taxonomyArchive type=button role=tab aria-controls=taxonomyArchives aria-selected=true>
アーカイブ
</button>
</li>
</ul>
<div class="tab-content mt-3">
<div class="tab-pane active" id=taxonomyTags role=tabpanel aria-labelledby=taxonomyTagsTab tabindex=0>
<a href=https://s-show.github.io/tags/3d%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=3Dプリンタ>
3Dプリンタ
<span class="badge badge-sm text-secondary bg-white ms-1">10</span>
</a>
<a href=https://s-show.github.io/tags/%E5%82%99%E5%BF%98%E9%8C%B2/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=備忘録>
備忘録
<span class="badge badge-sm text-secondary bg-white ms-1">10</span>
</a>
<a href=https://s-show.github.io/tags/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=プログラミング>
プログラミング
<span class="badge badge-sm text-secondary bg-white ms-1">5</span>
</a>
<a href=https://s-show.github.io/tags/%E8%87%AA%E4%BD%9C%E3%82%AD%E3%83%BC%E3%83%9C%E3%83%BC%E3%83%89/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=自作キーボード>
自作キーボード
<span class="badge badge-sm text-secondary bg-white ms-1">5</span>
</a>
<a href=https://s-show.github.io/tags/%E8%AA%AD%E6%9B%B8%E8%A8%98%E9%8C%B2/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=読書記録>
読書記録
<span class="badge badge-sm text-secondary bg-white ms-1">3</span>
</a>
<a href=https://s-show.github.io/tags/klipper/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Klipper>
Klipper
<span class="badge badge-sm text-secondary bg-white ms-1">2</span>
</a>
<a href=https://s-show.github.io/tags/mac/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Mac>
Mac
<span class="badge badge-sm text-secondary bg-white ms-1">2</span>
</a>
<a href=https://s-show.github.io/tags/mainsail/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Mainsail>
Mainsail
<span class="badge badge-sm text-secondary bg-white ms-1">2</span>
</a>
<a href=https://s-show.github.io/tags/%E6%9C%AA%E5%88%86%E9%A1%9E/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=未分類>
未分類
<span class="badge badge-sm text-secondary bg-white ms-1">2</span>
</a>
<a href=https://s-show.github.io/tags/karabiner-elements/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Karabiner-Elements>
Karabiner-Elements
<span class="badge badge-sm text-secondary bg-white ms-1">1</span>
</a>
<a href=https://s-show.github.io/tags class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=全部>
全部
<span class="badge badge-sm text-secondary bg-white ms-1">13</span>
</a>
</div>
<div class=tab-pane id=taxonomyArchive role=tabpanel aria-labelledby=taxonomyArchiveTab tabindex=0>
<a href=https://s-show.github.io/archives/2022/ class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2022>
2022 <span class="badge badge-sm text-secondary bg-white ms-1">14</span>
</a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2021>
2021 <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
</a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2020>
2020 <span class="badge badge-sm text-secondary bg-white ms-1">2</span>
</a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2019>
2019 <span class="badge badge-sm text-secondary bg-white ms-1">4</span>
</a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2018>
2018 <span class="badge badge-sm text-secondary bg-white ms-1">2</span>
</a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2017>
2017 <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
</a>
</div>
</div>
</div>
</section>
</div>
<div class="accordion posts-toggle">
<section class="row card component accordion-item">
<div class="accordion-header card-header border-0">
<a class="accordion-button d-lg-none mb-1 collapsed shadow-none p-0 bg-transparent" type=button data-bs-toggle=collapse data-bs-target=#posts-toggle aria-expanded=false aria-controls=posts-toggle>
投稿
</a>
</div>
<div class="card-body collapse accordion-collapse accordion-body d-lg-block" id=posts-toggle>
<ul class="nav nav-pills nav-fill" id=myTab role=tablist>
<li class=nav-item role=presentation>
<button class="nav-link active" id=recent-posts-tab data-bs-toggle=tab data-bs-target=#recent-posts type=button role=tab aria-controls=recent-posts aria-selected=true>
最近の投稿
</button>
</li>
</ul>
<div class="tab-content mt-3">
<div class="tab-pane active" id=recent-posts role=tabpanel aria-labelledby=recent-posts-tab tabindex=0>
<ul class="post-list list-unstyled ms-1">
<li class=mb-2>
<div class=d-flex>
<div class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
<a class=post-title href=https://s-show.github.io/posts/2022-09-19/>スライサーの設定で Pressure_advance の設定値を変更する方法</a>
<div class="post-meta mt-2">
<span class=post-date>2022-09-19</span>
</div>
</div>
</div>
</li>
<li class=mb-2>
<div class=d-flex>
<div class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
<a class=post-title href=https://s-show.github.io/posts/2022-09-05/>QMK Firmware で1つのキーに Hold/Double Tap を割り当てる方法</a>
<div class="post-meta mt-2">
<span class=post-date>2022-09-18</span>
</div>
</div>
</div>
</li>
<li class=mb-2>
<div class=d-flex>
<div class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
<a class=post-title href=https://s-show.github.io/posts/2022-09-03/>SuperSlicer で 一定の高さ毎に温度やリトラクト長を変える方法</a>
<div class="post-meta mt-2">
<span class=post-date>2022-08-31</span>
</div>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</section>
</div>
</div>
</aside>
<div class=col-lg-8>
<div class=container><nav class="row card component" aria-label=breadcrumb>
<div class="card-body pb-0">
<ol class=breadcrumb><li class="breadcrumb-item text-surface"><a href=https://s-show.github.io/>ホーム</a></li><li class="breadcrumb-item text-surface"><a href=https://s-show.github.io/posts/>Posts</a></li><li class="breadcrumb-item active">AutoHotKeyの解説と自分の設定について</li></ol>
</div>
</nav><div class="post-panel-wrapper position-sticky">
<div class="d-flex flex-column component rounded post-panel position-absolute border">
<a class="action action-panel-toggler" role=button title="Panel toggler">
<i class="fas fa-fw fa-chevron-circle-down"></i>
</a>
<a id=sidebarToggler class="action d-none d-lg-block" role=button title="Sidebar toggler">
<i class="fas fa-fw fa-expand-alt" data-fa-transform=rotate-45></i>
</a>
<a class=action href=#post-copyright role=button aria-label=Copyright title=Copyright>
<i class="fas fa-fw fa-copyright"></i>
</a>
<a class=action href=#post-comments role=button aria-label=Comments title=Comments>
<i class="fas fa-fw fa-comments"></i>
</a>
</div>
</div><article class="row card component mb-4 post">
<div class=card-header>
<h1 class="card-title post-title my-2">AutoHotKeyの解説と自分の設定について</h1>
</div>
<div class=card-body><div class="post-meta mb-3">
<span class="post-date me-1 mb-1" title="公開: 2019-06-18 11:35:06 +0000 UTC.">2019-06-18</span><a href=https://s-show.github.io/tags/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-tag">プログラミング</a><a href=https://s-show.github.io/tags/%E5%82%99%E5%BF%98%E9%8C%B2/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-tag">備忘録</a>
</div>
<div class="post-content mb-3" data-bs-spy=scroll data-bs-target=#TableOfContents tabindex=0><h2 id=前置き data-numberify>前置き<a class="anchor ms-1 d-none" href=#前置き>#</a></h2>
<p>自作キーボードキットのErgoDashを組み立てて日々使っているが、以下のページで紹介されている方法を使って、Raise/Lowerキーを「単独で押せば変換/無変換 or かな/英数、他のキーと組み合わせて押せばRaise/Lower」となるように設定して使っている。</p>
<p><a href=http://okapies.hateblo.jp/entry/2019/02/02/133953 target=_blank rel="noopener noreferrer">QMK Firmware で Raise/Lower と変換/無変換を同じキーに割り当てる<i class="fas fa-external-link-square-alt ms-1"></i></a></p>
<p>MacOSは「かな/英数キー」でIMEのオン/オフが切り替えられ、Windowsも、enthumbleというアプリを使えば「変換/無変換キー」で同じことができるので、こうした設定を行なっている。</p>
<p>MacOSではこの設定で問題なくIMEを切り替えられたのだが、Windowsで同じことを実現しようとした時に思いっきりつまづいてしまった。</p>
<p>試行錯誤の末に、WindowsでもIMEをMacOSと同様に切り替えられるようになったのだが、そのときの知見を備忘録代わりにまとめておこうと思う。</p>
<h2 id=enthumbleとは data-numberify>enthumbleとは？<a class="anchor ms-1 d-none" href=#enthumbleとは>#</a></h2>
<p>前置きでも少し触れているが、Windowsで出番がほとんどない無変換キーをFnキーの代わりとして使うことで、「無変換-HJKL」でカーソル移動、「無変換-スペース」でEnterキーを入力、「無変換-S」でCtrl-Sを入力、といった機能に加えて、変換/無変換キーをIMEのオン/オフのキーとして使えるようにするアプリである。</p>
<p><a href=https://qiita.com/mhara/items/d2d072592a4db9243c99 target=_blank rel="noopener noreferrer">enthumble Readme 【説明書】 - Qiita<i class="fas fa-external-link-square-alt ms-1"></i></a></p>
<p>自作キーボードを使う前から重宝していたアプリなのだが、自作キーボード導入後はしばらくWindowsPCを操作していなかったので、自作キーボード導入後の最初のWindowsPC操作の時点で、変換/無変換キーをIMEの切り替えに使えないという問題に遭遇してしまったのである。</p>
<h2 id=最初の悪戦苦闘 data-numberify>最初の悪戦苦闘<a class="anchor ms-1 d-none" href=#最初の悪戦苦闘>#</a></h2>
<p>enthumbleを入れても変換/無変換キーをIMEのオン/オフキーとして使えなかったので、まずは、本当に変換/無変換がWindowsに送信されているのか調べることにした。</p>
<p>調査では、まず、<a href=https://forest.watch.impress.co.jp/library/software/changekey/ target=_blank rel="noopener noreferrer">Change Key<i class="fas fa-external-link-square-alt ms-1"></i></a>というキーボードカスタマイズソフトのキーコード調査機能を使ったのだが、以下のスクリーンショットのとおり、ちゃんと変換/無変換キーが送信されているという結果が出てきた。</p>
<p><picture><img class=img-fluid alt src=https://kankodori-blog.com/wp-content/uploads/2019/07/764c5c650717871cf7b41f223001333a.png loading=lazy>
</picture>
</p>
<p>変換/無変換キーが送信されているのは確認できたので、Raise/Lowerキーを「単独で押せば変換/無変換、他のキーと組み合わせたらRaise/Lower」という設定がきちんとできていることは確認できたのだが、それでもenthumbleが動作しない理由が分からなかった。とりあえず、enthumbleを再インストールしたりWindowsを再起動したりといった定番の作業は行ったが、一向に問題が解決しない。</p>
<p>ここで、enthumbleを使うことは諦めて、キーボードカスタマイズソフトの<a href=https://www.autohotkey.com/ target=_blank rel="noopener noreferrer">AutoHotkey<i class="fas fa-external-link-square-alt ms-1"></i></a>を使うことにした。</p>
<h2 id=autohotkeyとは data-numberify>AutoHotKeyとは？<a class="anchor ms-1 d-none" href=#autohotkeyとは>#</a></h2>
<p>AutoHotKeyは、元々はキーボードカスタマイズソフトとして開発されていたが、ユーザーの要望を取り入れながら開発しているうちに、Windowsの動作制御までできるようになったソフトである。</p>
<p>本当に多機能なソフトで、</p>
<ul>
<li>アプリ毎に自分用のショートカットキーを作る</li>
<li>変換/無変換キーをIMEの制御キーする</li>
<li>アプリ操作を自動化</li>
<li>GUIフォームを備えたアプリを作成する</li>
</ul>
<p>といった具合に、とにかく色んなことができるようになるソフトである。</p>
<p><a href=https://itjo.jp/autohotkey/what-is-autohotkey/ target=_blank rel="noopener noreferrer">[AHK基礎] AutoHotkeyはどんな言語か - ITジョー<i class="fas fa-external-link-square-alt ms-1"></i></a></p>
<p><a href=https://www.norick-matsumoto.com/entry/autohotkey_rpa target=_blank rel="noopener noreferrer">RPA（ロボテックプロセスオートメーション）なくても、AutoHotKeyでPC入力自動化できますが何か？ - ノリックのIT生産性向上、ライフハック、プロマネのお仕事備忘録<i class="fas fa-external-link-square-alt ms-1"></i></a></p>
<p><a href=https://qiita.com/sta/items/c695b91457ee73b3ddf9 target=_blank rel="noopener noreferrer">Windows で簡単な GUI ラッパーアプリを作るなら AutoHotkey が良さそうという話 - Qiita<i class="fas fa-external-link-square-alt ms-1"></i></a></p>
<p><a href=http://funcs.org/1024 target=_blank rel="noopener noreferrer">Auto Hot Keyで簡単にGUIフォームアプリを作る | 読書とプログラミングを中心とした覚書ブログ<i class="fas fa-external-link-square-alt ms-1"></i></a></p>
<p>また、書いたスクリプトを.exeファイルにコンパイルすることもできるので、自作の設定を他人に使ってもらうことも可能である。ちなみに、enthumbleもAutoHotKeyで作成されている。</p>
<p>ただし、様々なことができるとはいえ、自分でスクリプトを書かないといけないので、マウスでぽちぽちクリックすればOKと言う訳ではない。とはいえ、自分用のショートカットキーを作ったり、IMEの制御を「全角/半角」キー以外で行うと言うレベルであれば、そこまで難しいものではない。</p>
<p>というわけで、AutoHotKeyの使い方を簡単に紹介するとともに、私が行っている設定も紹介したいと思う。</p>
<h2 id=autohotkeyの使い方 data-numberify>AutoHotKeyの使い方<a class="anchor ms-1 d-none" href=#autohotkeyの使い方>#</a></h2>
<p>詳しい使い方については、ネットを検索すれば優れた先人の解説がいくつも見つかるので、本記事では基本的な部分に絞って解説する。</p>
<p><a href=https://rion778.hatenablog.com/entry/20091208/1260241968 target=_blank rel="noopener noreferrer">AutoHotkeyのチュートリアルを読んだ - もうカツ丼はいいよな<i class="fas fa-external-link-square-alt ms-1"></i></a></p>
<p><a href=https://www.norick-matsumoto.com/entry/autohotkey target=_blank rel="noopener noreferrer">Autohotkeyに関する記事で1万字超えの記事を書き、 Google からの検索流入が一か月後に増加するかどうかを確認しつつ、タイトルはやっぱり長い方が良いのかも検証する - ノリックのIT生産性向上、ライフハック、プロマネのお仕事備忘録<i class="fas fa-external-link-square-alt ms-1"></i></a></p>
<p><a href=http://ahkwiki.net/Top target=_blank rel="noopener noreferrer">AutoHotkey Wiki<i class="fas fa-external-link-square-alt ms-1"></i></a></p>
<p><a href=https://so-zou.jp/software/tool/system/auto-hot-key/ target=_blank rel="noopener noreferrer">AutoHotKeyの使用方法<i class="fas fa-external-link-square-alt ms-1"></i></a></p>
<h3 id=基本的な構文 data-numberify>基本的な構文<a class="anchor ms-1 d-none" href=#基本的な構文>#</a></h3>
<p>AutoHotKeyでMyショートカットキー（AutoHotKeyではホットキーと呼ぶ）を作成する場合、<code>*.ahk</code>という拡張子の設定ファイルに<code>ホットキーを割り当てるキー::</code>という形でコードを書く。こう書くことで、AutoHotKeyではサブルーチンのラベルとして認識され、指定のキーを押すと、ラベルの次の行以降に処理が移り、<code>Return</code>か<code>Exit</code>が実行されるまで処理が続けられる。</p>
<p>なお、<code>/* ~ */</code>という構文はコメントである。</p>
<pre tabindex=0><code>/*
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
example2: Alt-Qの2連打でアプリを閉じる
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
*/
~!q::
  Input, inputText, I L1 T0.5, !q
  IfInString, ErrorLevel, EndKey:
  {
    Send, !{F4}
  }
Return
</code></pre><p>なお、割り当てる処理が1行で足りる場合、以下のコードのように<code>Return</code>を省略できる。</p>
<pre tabindex=0><code>/*
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
example1: Ctrl-Alt-Rでこのスクリプトを再読み込みする
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
*/
^!r::Reload
</code></pre><h3 id=ホットキーの指定方法 data-numberify>ホットキーの指定方法<a class="anchor ms-1 d-none" href=#ホットキーの指定方法>#</a></h3>
<p>ホットキーを指定するには、<a href=http://ahkwiki.net/KeyList target=_blank rel="noopener noreferrer">こちらに掲載されている<i class="fas fa-external-link-square-alt ms-1"></i></a>キーリストに沿って指定するが、基本的に、アルファベットキーは印字通り（大文字小文字は不問）指定すればOKである。BackSpaceやReturnなどのキーも、基本的にキーの印字通りでOKである。</p>
<p>一方、変換/無変換のような一部のキーは、<code>vkXX(仮想キーコード)</code>か<code>scYYY(スキャンコード)</code>というキーコードで指定する必要がある。キー毎の具体的なコードは、上記のリンク先を参考にするか、AutoHotKeyのキースキャン機能で確認できる。</p>
<p>なお、注意事項として、ネットでは<code>vkXXscYYY</code>という指定方法が散見されるが、この方式は、2017年12月25日にリリースされたバージョン1.1.27.00で<code>*.ahk</code>スクリプトのバリデーションが変更されたことにより、現在ではエラーとなる。そのため、現在は<code>vkXX</code>か<code>scYYY</code>と指定する。</p>
<p>CtrlやAltキーなどのモディファイヤキーと組み合わせるホットキーを指定する際は、以下の表に示したコードと組み合わせて指定する（例: <code>^j</code>）。上の設定例の<code>^!r</code>は"Ctrl-Alt-R"という組み合わせを指定している。</p>
<table>
<thead>
<tr>
<th>キー名</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>shift</td>
</tr>
<tr>
<td>^</td>
<td>control</td>
</tr>
<tr>
<td>!</td>
<td>alt</td>
</tr>
<tr>
<td>#</td>
<td>windows</td>
</tr>
</tbody>
</table>
<p>なお、上の設定例の<code>~!q::</code>の行頭にある<code>~</code>は、押したキーをそのままシステムに通すという設定である。この例で言えば、&ldquo;Alt-Q"というキーをAutoHotKeyで受け取った後システムにも渡すという設定である。</p>
<h3 id=変数と条件分岐 data-numberify>変数と条件分岐<a class="anchor ms-1 d-none" href=#変数と条件分岐>#</a></h3>
<h4 id=変数 data-numberify>変数<a class="anchor ms-1 d-none" href=#変数>#</a></h4>
<p>変数は、事前の宣言不要で<code>MyVar = 123abc</code>の形で値を代入できる。また、変数の値の展開は<code>MsgBox, MyVar is %MyVar%</code>のように<code>%</code>で囲めばOKである。</p>
<p>なお、関数の返り値を変数に代入する際は、<code>MyVar := function()</code>のように、<code>=</code>ではなく<code>:=</code>とする必要がある。</p>
<p>参考</p>
<ul>
<li><a href=http://ahkwiki.net/Scripts#.E5.A4.89.E6.95.B0 target=_blank rel="noopener noreferrer">スクリプト仕様 - 変数 - AutoHotkey Wiki<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
</ul>
<h4 id=条件分岐 data-numberify>条件分岐<a class="anchor ms-1 d-none" href=#条件分岐>#</a></h4>
<p><code>If</code>文による条件分岐が可能であり、<code>Else</code>で<code>If</code>の条件に当てはまらない場合の処理が指定できる。その場合、<code>Else</code>の後に<code>If</code>を追加して細かい条件分岐を行うことも可能である。</p>
<pre tabindex=0><code>If MyVar &gt; 10000
    MsgBox,&quot;たくさん&quot;
Else If MyVar &gt; 1000
    MsgBox,&quot;多い&quot;
Else
    MsgBox,&quot;そこそこ&quot;
</code></pre><p><code>If</code>文による条件分岐は、「等しい、以上・以下、超・未満」のような判定に加えて、指定した文字列が含まれているか、変数のデータ型が特定の型に等しいか、という判定も可能である。</p>
<p>参考</p>
<ul>
<li><a href=http://ahkwiki.net/Scripts#.E6.9D.A1.E4.BB.B6.E5.88.86.E5.B2.90 target=_blank rel="noopener noreferrer">スクリプト仕様 - 条件分岐 - AutoHotkey Wiki<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
</ul>
<h3 id=設定ファイルの分割 data-numberify>設定ファイルの分割<a class="anchor ms-1 d-none" href=#設定ファイルの分割>#</a></h3>
<p>AutoHotKeyの設定は<code>*.ahk</code>ファイルに書いていくが、全ての設定を1つのファイルに書く必要はなく、複数の<code>*.ahk</code>ファイルに書くことが可能である。設定が増えた際の管理の手間を考えると、アプリ毎の設定ファイル、Windows全体で適用する設定ファイルのように、目的別で分けた方が良いと思う。</p>
<p>私の場合、IME関係(<code>IME-setting.ahk</code>)、アプリ毎の設定(<code>settings-for-each-app.ahk</code>)、その他の設定(<code>misc-setting.ahk</code>)の3つに分けて管理しており、その3つのファイルを<code>my_keybind.ahk</code>で以下のとおり読み込んでいる。なお、1行目では各設定で使う<code>IME.ahk</code>を読み込んでいる。ここで読み込むと、それぞれの設定ファイルでは改めて読み込む必要がなくなる。</p>
<pre tabindex=0><code>#Include %A_ScriptDir%/IME.ahk
#Include %A_ScriptDir%/IME-setting.ahk
#Include %A_ScriptDir%/settings-for-each-app.ahk
#Include %A_ScriptDir%/misc-setting.ahk
Return
</code></pre><p>実際のファイルを確認したい人は、私のGitHubの<a href=https://github.com/s-show/AutoHotKey target=_blank rel="noopener noreferrer">リポジトリ<i class="fas fa-external-link-square-alt ms-1"></i></a>を確認して欲しい。</p>
<p>参考</p>
<ul>
<li><a href=http://ahkwiki.net/-Include target=_blank rel="noopener noreferrer">#Include / #IncludeAgain - AutoHotkey Wiki<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
</ul>
<h2 id=具体的な設定 data-numberify>具体的な設定<a class="anchor ms-1 d-none" href=#具体的な設定>#</a></h2>
<p>AutoHotKeyの各機能を1つ1つ説明すると非常に長くなるし、そもそも「まずホットキーを指定し、そのホットキーに処理を割り当てる」というスタイルで設定していくアプリなので、これ以降は具体的な設定を逐一解説することで、AutoHotKeyの使い方を説明するという流れにする。</p>
<h3 id=imeのオンオフの切り替え data-numberify>IMEのオン/オフの切り替え<a class="anchor ms-1 d-none" href=#imeのオンオフの切り替え>#</a></h3>
<p>最初は、上記のとおり悪戦苦闘したIMEのオン/オフの切り替えから。</p>
<p>キーコードの指定でつまずいたが、以下のコードで望み通りの動作を実現することができた。</p>
<pre tabindex=0><code>/*
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Title: 変換/無変換でIMEをオン/オフする
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
*/
SC079::IME_SET(1)
SC07B::
  if IME_GetConverting() &gt;= 1 {
    Return
  }
  else {
    IME_SET(0)
  }
  Return
</code></pre><p>この設定で使用している<code>IME_SET()</code>関数と<code>IME_GetConverting</code>関数は、前述の「設定ファイルの分割」の1行目（<code>#Include %A_ScriptDir%/IME.ahk</code>）で読み込んだ<code>IME.ahk</code>で定義されている。IME周りの制御では必須の関数が定義されているスクリプトファイルなので、IME制御を行うなら必ずダウンロードすることになる。</p>
<p>スクリプトを解説すると、6行目で"変換"キーをホットキーに、7行目で"無変換"キーをそれぞれホットキーに指定している。</p>
<p>変換/無変換キーはキーコードを使ってホットキーに指定する必要があるので、上記の設定を行う前にキーコードを調査した。調査画面は次のとおりである。</p>
<figure class="figure bsimage">
<img src=image1.png class="figure-img img-fluid">
<figcaption class="figure-caption fw-light text-center">調査結果</figcaption>
</figure>
<p>ここで、変換キーのスキャンコード(SC)が<code>079</code>、無変換キーのスキャンコードが<code>07B</code>だと分かるので、<code>SC079</code>、<code>SC07B</code>と指定した。そのうえで、変換キーにIMEオンの機能を割り当てるため、<code>IME.ahk</code>に定義されている<code>IME_SET</code>関数を使用した。<code>IME_SET(1)</code>でIMEをオンに、<code>IME_SET(0)</code>でオフにできる。</p>
<p>次に、無変換キーにIMEオフの機能を割り当てるが、私のErgoDashでは、無変換キーがスペースキーの隣の親指担当の場所にあるため、スペースキーと間違えて無変換キーを押すことがしばしばあった。そのため、IMEオンで入力しているときは、無変換キーを押してもIMEをオフにしない設定にした。</p>
<p>そのため、<code>IME_GetConverting</code>関数でIMEの状態を確認し、返り値が<code>1</code>以上（IMEオンで入力中 or 変換中）なら、何もしない（<code>Return</code>で処理終了）設定にし、それ以外の場合（IMEオンだが入力していない）に<code>IME_SET(0)</code>関数を実行してIMEをオフにする設定にした。</p>
<p>なお、<code>IME_GetConverting</code>関数でIMEの状態が取得できるのは、インラインで入力が行われないアプリだけである。そのため、WordやNotepadのようにインラインで入力が行われるアプリでは、IMEの状態が取得できないので、入力中はIMEをオフにしないという細かい調節はできない。</p>
<p>参考</p>
<ul>
<li><a href=https://www6.atwiki.jp/eamat/pages/17.html target=_blank rel="noopener noreferrer">IME制御 - eamat @Cabinet - アットウィキ<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
</ul>
<h4 id=補足 data-numberify>補足<a class="anchor ms-1 d-none" href=#補足>#</a></h4>
<p>ちなみに、上記で調査した変換/無変換キーのスキャンコードは、市販のJISキーボードでも同じである。しかし、仮想コードはErgoDashと市販のキーボードで異なっている。</p>
<p>キーの指定は、スキャンコードか仮想コードで行うので、enthumbleは、スキャンコードではなく仮想コードで指定しているか、それとも<code>vkXXscYYY</code>という組み合わせで指定しているのではないかと思う。そのため、ErgoDashでは動作しなかったのではないかと思う。</p>
<table>
<thead>
<tr>
<th>仮想キーコード</th>
<th>変換</th>
<th>無変換</th>
</tr>
</thead>
<tbody>
<tr>
<td>ErgoDash</td>
<td>FF</td>
<td>EB</td>
</tr>
<tr>
<td>市販品</td>
<td>1C</td>
<td>1D</td>
</tr>
</tbody>
</table>
<h3 id=ime関連の他の設定 data-numberify>IME関連の他の設定<a class="anchor ms-1 d-none" href=#ime関連の他の設定>#</a></h3>
<p>これで最大の懸念であったIMEの切り替えが実現できたが、変換キーにIMEオンの機能を割り当てたので、本来の変換キーが無くなっている。誤入力した箇所にカーソルを置いて変換キーを押すと再変換できる機能は便利なので、<code>Ctrl-BackSpace</code>に変換キーの機能を割り当てることにする。</p>
<pre tabindex=0><code>BS::Send, {vk1C}
</code></pre><p><code>BS</code>はBackSpaceの指定（<code>Backspace</code>でもOK）で、<code>Send</code>は、引数に指定したキーをシステムに送信するコマンドである。<code>vk1C</code>は変換キーの仮想キーコードなので、&ldquo;Ctrl-BackSpace"を押すと<code>変換</code>キーが送信されるという動作になる。</p>
<p>参考</p>
<ul>
<li><a href=http://ahkwiki.net/Send target=_blank rel="noopener noreferrer">Send / SendRaw / SendEvent / SendInput / SendPlay - AutoHotkey Wiki<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
</ul>
<h3 id=アプリ毎の設定 data-numberify>アプリ毎の設定<a class="anchor ms-1 d-none" href=#アプリ毎の設定>#</a></h3>
<p>AutoHotKeyでは、アプリ毎に設定を行うことも可能である。</p>
<p>次の例は、Excelで行（列）選択のショートカットキーのShift(Ctrl)-SpaceをIMEオンでも動作させるというものである（このショートカットキーはIMEオンだと動かない）。キーボードでExcelを操作するときに必須のショートカットキーなので、IMEオンでも動作するようにする。</p>
<pre tabindex=0><code>#ifWinActive ahk_exe EXCEL.EXE
  $^Space::
    if (IME_GET())
    {
      IME_SET(0)
      Sleep 30
      Send,^{Space}
      Sleep 30
      IME_SET(1)
    }
    else
    {
      Send,^{Space}
    }
    Return

  $+Space::
    if (IME_GET())
    {
      IME_SET(0)
      Sleep 30
      Send,+{Space}
      Sleep 30
      IME_SET(1)
    }
    else
    {
      Send,+{Space}
    }
    Return
#ifWinActive
</code></pre><p><code>IME_GET</code>関数や<code>IME_SET</code>関数は、上記のIME関連の設定で説明したとおり<code>IME.ahk</code>で定義されているものである。</p>
<p>1行目の<code>#ifWinActive</code>は、特定のウィンドウがアクティブの時だけ実行するというコマンドである。ウィンドウの指定はウィンドウタイトルやウィンドウクラスで行うが、ウィンドウタイトルで行うのが簡単だと思う。</p>
<p>ウィンドウタイトルの確認は、AutoHotKeyに備わっている「Window Spy」という機能を使うのがベストである。Window Spyは、右下のタスクトレイにあるAutoHotKeyのアイコンを右クリックしたメニューにあるので、そこから起動する。起動した後の操作方法は以下のスクリーンショットのとおり。</p>
<p>2行目の<code>$^Space::</code>は、&ldquo;Ctrl-Space"というホットキーを指定するものであるが、行頭に<code>$</code>をつけているのは、&ldquo;Ctrl-Space"をAutoHotKeyで強制的にフックするためである。システムが使うショートカットキーを上書きする場合に必要となる。</p>
<p>3行目の<code>if (IME_GET())</code>は、<code>IME_GET()</code>の返り値が<code>1</code>、つまりIMEがオンになっているという条件式である。AutoHotKeyは、数値が<code>0</code>なら<code>false</code>、それ以外の数値は<code>true</code>と処理するので、こういうコードでOKとなる。</p>
<p>5〜9行目はIMEがオンの場合の処理であるが、まず、5行目の<code>IME_SET(0)</code>でIMEをオフにし、続いて6行目の<code>Sleep 30</code>で30ミリ秒処理を中断する。この中断処理を除くとIMEオンの状態で"Ctrl-Space"を入力したのと同じ動作になるので、中断処理を行っている。なお、30ミリ秒より短いと上手くいかない。</p>
<p>それから7行目の<code>Send,^{Space}</code>で"Ctrl-Space"を送信し、8行目の<code>Sleep 30</code>で再び処理を中断している（この中断処理を省略しても上手く動作しない）。</p>
<p>そして、9行目の<code>IME_SET(1)</code>でIMEをオンに戻している。</p>
<p>11行目の<code>else</code>は、IMEがオフの場合の分岐で、この場合は、単純に13行目の<code>Send,^{Space}</code>で"Ctrl-Space"を送信している。</p>
<p>17行目の<code>$+Space::</code>は、&ldquo;Shift-Space"というホットキーを指定するものである。以降の設定はこれまでと同じなので、省略する。</p>
<p>なお、Excelについては、次のような設定も行なっている。説明の都合上2つに分けているが、<a href=https://github.com/s-show/AutoHotKey/blob/b16ebad926283611146d225197081905085ccd5c/settings-for-each-app.ahk#L93 target=_blank rel="noopener noreferrer">実際の設定ファイル<i class="fas fa-external-link-square-alt ms-1"></i></a>では、<code>#ifWinActive</code>を除いた部分を上記のコードの続きに書いている。</p>
<pre tabindex=0><code>#ifWinActive ahk_exe EXCEL.EXE
  $F1::Return
    $+F1::SendInput, {F1}
#ifWinActive
</code></pre><p>2行目の<code>$F1::Return</code>は、&ldquo;F1"キーを無効化する設定である。以前使っていたキーボードで、F1キーがEscキーの隣にあるためにEscとF1をの押し間違いが頻発していたので、思い切ってF1を無効化したのである。特定のキーを無効化する場合、<code>無効化したいキー::Return</code>とすることで、そのキーを無効化できる。</p>
<p>なお、F1キーを無効化したが、ヘルプを見たい時があるかもしれないので、<code>$+F1::SendInput, {F1}</code>で"Shift-F1"に元々のF1を割り当てている。</p>
<p>参考</p>
<ul>
<li><a href=http://ahkwiki.net/IfWinActive target=_blank rel="noopener noreferrer">IfWinActive / IfWinNotActive - AutoHotkey Wiki<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
</ul>
<h3 id=キー２連打への割り当て data-numberify>キー２連打への割り当て<a class="anchor ms-1 d-none" href=#キー２連打への割り当て>#</a></h3>
<p>キー２連打への割り当て方法は２通りあるので、それぞれ紹介する。</p>
<h4 id=方法１モディファイヤキーが無い場合 data-numberify>方法１（モディファイヤキーが無い場合）<a class="anchor ms-1 d-none" href=#方法１モディファイヤキーが無い場合>#</a></h4>
<p>CtrlやAltなどのモディファイヤキーと組み合わせないキーの２連打の場合、AutoHotKeyの組み込み変数を使うことで簡単に２連打の設定ができる。</p>
<pre tabindex=0><code>/*
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Title: テンキーのピリオド2連打でカンマ入力
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
*/
~NumpadDot::
  If (A_PriorHotKey == A_ThisHotKey and A_TimeSincePriorHotkey &lt; 200)
  {
    SendInput, {BackSpace 2}
    Send,{U+002c}
  }
Return
</code></pre><p>上記のコードを解説すると、まず、<code>~NumpadDot::</code>でテンキーの&rdquo;.&ldquo;をホットキーに指定している。行頭に<code>~</code>を追加しているので、&rdquo;.&ldquo;の入力はシステムにも渡されて&rdquo;.&ldquo;が入力される。</p>
<p>そして、7行目の<code>If (A_PriorHotKey == A_ThisHotKey and A_TimeSincePriorHotkey &lt; 200)</code>は、組み込み変数を使って、「前回入力されたホットキーと今回のホットキーが同じ」かつ「前回のホットキー入力から今回のホットキー入力までの時間が200ミリ秒未満」という条件文を組み立てている。</p>
<p><code>A_PriorHotKey</code>変数には前回押されたホットキー、<code>A_ThisHotKey</code>変数には今回押されたホットキーが格納されているので、2つの変数が等しければ同じホットキーを2回連続で入力したと判断できる。そして、<code>A_TimeSincePriorHotkey</code>変数には、前回のホットキー入力から今回のホットキー入力までの時間がミリ秒単位で格納されているので、この変数の値が200未満なら２連打したと判断している。</p>
<p>つまり、最初の&rdquo;.&ldquo;入力では、7行目の<code>If</code>文の条件が必ず満たされず最後の<code>Return</code>コマンドに直行し、2回目の&rdquo;.&ldquo;入力で7行目の<code>If</code>分の条件が満たされて、次の<code>Send~</code>の処理に移るという訳である。</p>
<p>そして、この段階までに2回入力されている&rdquo;.&ldquo;を削除するため、<code>SendInput, {BackSpace 2}</code>コマンドでBackSpaceを2回入力している。それから<code>Send,{U+002c}</code>コマンドで&rdquo;,&ldquo;を入力している。なお、<code>{U+002c}</code>は、&rdquo;,&ldquo;のUnicodeの文字コードである。わざわざUnicodeの文字コードで指定している理由は、<code>Send,{,}</code>だとIMEがオンの場合に全角の&rdquo;、&ldquo;が入力されてしまうためである。</p>
<p>参考</p>
<ul>
<li><a href=http://ahkwiki.net/Variables#.E3.83.9B.E3.83.83.E3.83.88.E3.82.AD.E3.83.BC.E3.83.BBGUI.E9.96.A2.E9.80.A3 target=_blank rel="noopener noreferrer">組み込み変数 - AutoHotkey Wiki<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
<li><a href=http://ahkwiki.net/IfExpression target=_blank rel="noopener noreferrer">If (式)<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
<li><a href=https://tools.m-bsys.com/ex/unicode_table.php target=_blank rel="noopener noreferrer">Unicode文字一覧表 - instant tools<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
</ul>
<h4 id=方法２モディファイヤキーがある場合 data-numberify>方法２（モディファイヤキーがある場合）<a class="anchor ms-1 d-none" href=#方法２モディファイヤキーがある場合>#</a></h4>
<p>CtrlやAltなどのモディファイヤキーと組み合わせたキーの２連打の場合、上記より面倒になる。</p>
<pre tabindex=0><code>/*
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Title: Alt-Qの2連打でアプリを閉じる
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
*/
~!q::
  Input, inputText, I L1 T0.5, !q
  IfInString, ErrorLevel, EndKey:
  {
    Send, !{F4}
  }
Return
</code></pre><p>最初に掲載した設定例の再掲であるが、解説すると、まず<code>~!q::</code>で"Alt-Q"をホットキーに指定している。</p>
<p>そして、<code>Input</code>コマンドで最初の"Alt-Q"に続くキー入力を横取りして、<code>inputText</code>変数に格納している。</p>
<p><code>Input</code>コマンドの<code>I L1 T0.5</code>という引数は、「AutoHotKeyが生成したキー入力は無視、入力を受け付けるキーの長さは1文字、キー入力を待つ時間は0.5秒以内」という条件を指定するもので、<code>!q</code>という引数は、「&ldquo;Alt-Q"が入力されたらコマンドを終了して次の行に進む」という条件を指定するものである。</p>
<p>その次の<code>IfInString, ErrorLevel, EndKey:</code>は、「<code>ErrorLevel</code>変数に<code>EndKey:</code>という文字列が含まれているか」という条件文である。</p>
<p><code>Input</code>コマンドの待ち時間（0.5秒）以内に"Alt-Q"が押されたら、<code>ErrorLevel</code>変数に<code>EndKey:!{q}</code>という値が格納され、0.5秒以内に"Alt-Q"が押されない場合は<code>Timeout</code>という値が格納されるので、<code>EndKey:</code>が含まれていれば「Alt-Qが２連打された」と判断できる。</p>
<p>そのうえで、<code>Send,!{F4}</code>で"Alt-F4"キーを送信してアプリを終了させている。</p>
<p>参考</p>
<ul>
<li><a href=http://ahkwiki.net/Input target=_blank rel="noopener noreferrer">Input - AutoHotkey Wiki<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
<li><a href=http://ahkwiki.net/IfInString target=_blank rel="noopener noreferrer">IfInString - AutoHotkey Wiki<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
</ul>
<h3 id=クリップボードを活用 data-numberify>クリップボードを活用<a class="anchor ms-1 d-none" href=#クリップボードを活用>#</a></h3>
<p>クリップボードを活用することで、選択した文字列を&rdquo;(&ldquo;や&rdquo;[&ldquo;や&rdquo;#&ldquo;で囲むということも可能になる。なお、このコードだけ Gist から引っ張っている理由は、コードの「<code>Send,{{}</code>」の <code>{{}</code> が Hugo のビルド時に文法エラー扱いされてビルドが中断されるのを避けるため。</p>
<script type=application/javascript src=https://gist.github.com/s-show/3077002eee1c266bc3cf7d835f5682bd.js></script>
<p>8行目の<code>backup = ClipboardAll</code>は、その時点でクリップボードに格納されているデータを<code>backup</code>変数に退避させる処理である。<code>ClipboardAll</code>変数は組み込み変数で、クリップボードのデータを読み取る際に使用する。</p>
<p>9行目の<code>Clipboard =</code>は、クリップボードを空にする処理である。<code>Clipboard</code>変数も組み込み変数で、クリップボードの中身を書き換える際に使用する。</p>
<p>10行目の<code>Send, ^c</code>で、&ldquo;Ctrl-C"をシステムに送信して選択中の文字列をコピーするが、コピー失敗に備えて、11行目に<code>ClipWait, 1</code>という処理を挟んでいる。<code>ClipWait</code>コマンドは、引数で指定した秒数の間待機し、時間内にコピーが成功すればその時点で<code>ErrorLevel</code>変数に<code>0</code>を格納する。そのため、<code>ErrorLevel</code>変数の値でコピーが成功したか否かが確認できるようになる。</p>
<p>12行目は<code>IME_GET()</code>関数で現在のIMEの状態を変数に格納している。この処理は<code>Send</code>コマンドで囲み文字を入力する方法なので、囲み文字を確実に半角入力するため、一度IMEをオフにする必要がある。そのため、処理実行前のIMEの状態を取得している。なお、関数の戻り値を変数に格納する際は<code>:=</code>で代入する必要がある。</p>
<p>15行目の<code>Input, inputText, I L1 T1,{Esc}, (,[,\`{,',",`,-,_,=,`%,`#,`*, ,|</code>は、前述の<code>Input</code>コマンドを使って、&ldquo;Ctrl-,&ldquo;の次に入力された文字が<code>( [ { ` - _ = % # | 半角スペース</code>だった場合に、その文字を<code>inputText</code>変数に格納している。なお、<code>{ ` # % *</code>はAutoHotKeyで特別な意味のある文字であることから、これらの文字を指定する際は<code>`</code>でエスケープ処理する必要があり、また、半角スペースは条件式の途中（この例では<code>|</code>の前）に書かないと認識されないという2点に注意が必要である。</p>
<p>16行目の<code>If ErrorLevel = Match</code>は、<code>Input</code>コマンドで<code>(,[,\`{,',",`,-,_,=,`%,`#,`*, ,|</code>が入力されていれば<code>ErrorLevel</code>変数に<code>Match</code>が格納されているので、それを分岐条件にしている。</p>
<p>あとは、18行目の<code>IME_SET(0)</code>でIMEをオフにして、入力された文字に応じた分岐を18行目以降の<code>If inputText =</code>で行い、</p>
<ol>
<li>入力された文字を<code>Send</code>コマンドで送信</li>
<li><code>Send,^v</code>コマンドでクリップボードの文字を貼り付け</li>
<li>再び入力された文字を<code>Send</code>コマンドで送信</li>
</ol>
<p>という処理を行うことで、選択した文字列を指定した文字で囲むという動作を実現している。</p>
<p>工夫が必要な点は、まず、<code>(,[,\`{</code>は、対になる<code>),],\`}</code>とセットで囲む必要があることから、この3つのカッコは個別に分岐条件を設定している。そのほかの囲み文字については、同じ文字を2回入力すればOKである。</p>
<p>また、半角スペースは<code>If inputText = " "</code>のような条件判定がどうやってもできなかったので、指定した変数のデータ型で判断する<code>if inputText is type</code>を使って、<code>inputText</code>が半角スペース（タブもOK）か否かによる条件判定を行なった。</p>
<p>そのほか、なぜか<code>#</code>は個別に条件判定を行う必要があったので、やむなく個別に判定している。</p>
<p>それ以外の囲み文字については、まとめて最後の<code>Else</code>節で処理している。</p>
<p>最後に、IMEの状態を処理前に戻して動作完了である。</p>
<p>参考</p>
<ul>
<li><a href=http://ahkwiki.net/Ifis target=_blank rel="noopener noreferrer">If var is [not] type - AutoHotkey Wiki<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
</ul>
<h3 id=設定ファイルの再読み込みを簡単に data-numberify>設定ファイルの再読み込みを簡単に<a class="anchor ms-1 d-none" href=#設定ファイルの再読み込みを簡単に>#</a></h3>
<p>設定ファイルを編集した場合、右下のタスクトレイにあるAutoHotKeyのアイコンを右クリックして「Reload This Script」をクリックする必要があるが、非常に面倒な作業なので、設定ファイル再読み込みのショートカットキーを作成する。</p>
<pre tabindex=0><code>/*
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Title: Ctrl-Alt-Rでこのスクリプトを再読み込みする
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
*/
^!r::Reload
</code></pre><p>最初の方で紹介した設定例の再掲であるが、<code>^!r</code>で"Ctrl-Alt-R"をホットキーとして指定し、現在実行中の設定ファイルの再読み込みを行う<code>Reload</code>コマンドを割り当てている。</p>
<p>参考</p>
<ul>
<li><a href=http://ahkwiki.net/Reload target=_blank rel="noopener noreferrer">Reload - AutoHotkey Wiki<i class="fas fa-external-link-square-alt ms-1"></i></a></li>
</ul>
</div></div><div class=card-footer>
<div class="post-navs d-flex justify-content-evenly"><div class="post-nav post-prev">
<i class="fas fa-fw fa-chevron-down post-prev-icon me-1" data-fa-transform=rotate-90></i>
<a href=https://s-show.github.io/posts/2018-03-22/>Macbook proでメモリ交換して電源が入らなくなってから復活するまでの経緯</a>
</div><div class="post-nav post-next">
<a href=https://s-show.github.io/posts/2019-07-22/>自作キーボードでLEDが点灯しない時のテスト方法と対処方法</a>
<i class="fas fa-fw fa-chevron-down post-next-icon ms-1" data-fa-transform=rotate-270></i>
</div></div>
</div></article><div class="post-copyright mb-3 row card component" id=post-copyright>
<div class=card-header>
<h2 class="card-title fs-4 my-2 text-surface">Copyright</h2>
</div>
<div class=card-body><a class="d-flex align-items-center flex-column" target=_blank rel="license noopener noreferrer" href=https://creativecommons.org/licenses/by/4.0/deed.en>
<span><i class="fab fa-fw fa-2x fa-creative-commons"></i><i class="fab fa-fw fa-2x fa-creative-commons-by"></i></span>
CC BY 4.0
</a>
</div>
</div><section class="related-posts row card component">
<div class=card-header>
<h2 class="card-title fs-4 my-2 text-surface">関連する投稿</h2>
</div>
<div class=card-body>
<ul class="post-list list-unstyled"><li class="mb-3 border-bottom">
<a class=post-title href=https://s-show.github.io/posts/2018-03-22/>
Macbook proでメモリ交換して電源が入らなくなってから復活するまでの経緯
</a>
<span class="post-meta post-date float-end">2018-05-22
</span>
<div class="post-summary my-3"><p>前置き# メルカリで売りに出ていた「Macbook pro, 2011Early, 15インチ」を購入して、さらにメモリを16GBに増強して快適な環境を構築しようとしたら、メモリ交換後に電源ボタンを押しても反応がないというまさかの事態に陥ってしまった。何とか蘇らせることができてこの記事を書けるまでになったので、同じ症状に遭遇した人のために、顛末を書いてみたいと思う。
経緯（購入まで）# それまで使用していたMacbook pro(2015, 13インチ)は、持ち歩きも考慮して13インチにしたものの、据え置きで使うことが多く、また、据え置きで使うべく外付けディスプレイやキーボードを接続しているので、外に持ち出す都度、ケーブル類や電源の...</p><div><a class="btn btn-sm btn-outline-primary btn-read-more" href=https://s-show.github.io/posts/2018-03-22/>もっと読む</a></div></div>
</li><li class="mb-3 border-bottom">
<a class=post-title href=https://s-show.github.io/posts/2017-11-25/>
Karabiner-Elementsを使ってMacのキーボード操作を快適にする方法
</a>
<span class="post-meta post-date float-end">2017-11-25
</span>
<div class="post-summary my-3"><p>Karabiner-Elementsとは# Karabiner-Elementsは、Macのキーボードカスタマイズアプリで、設定ファイルを自分で記述することで以下のような機能を実現できます。
“control-H"のようなキー入力を"Command-A"の入力に変換 “Escape"を１回入力したら"Escape, 英数, Escape"のようなキー入力を実現する “control-2"のようなキー入力に"open -a 'safari'"のようなシェルコマンドの実行を割り当てる “スペースバー"を押している間だけ、“H, J, K, L"をカーソルキーに変換する “control-x control-c"のようなキー入力...</p><div><a class="btn btn-sm btn-outline-primary btn-read-more" href=https://s-show.github.io/posts/2017-11-25/>もっと読む</a></div></div>
</li><li class="mb-3 border-bottom">
<a class=post-title href=https://s-show.github.io/posts/2018-02-12/>
【読書記録】日本軍兵士――アジア・太平洋戦争の現実
</a>
<span class="post-meta post-date float-end">2018-02-12
</span>
<div class="post-summary my-3"><p> 日本軍兵士―アジア・太平洋戦争の現実 (中公新書) 太平洋戦争において、日本軍が補給をおろそかにしたことで前線の兵士が塗炭の苦しみを味わったことは周知の事実であるが、その苦しみがどれほどのものであったかを克明に記したのが本書である。
膨大な戦病死と餓死や、劣悪極まりない輸送船の悲劇などは他の書籍でも描かれているが、本書は大量の資料――日本軍と戦った米軍側の資料も含めて――を駆使してそうした事実を「兵士の目線」で「兵士の立ち位置」から捉えなおし、その悲惨な現実を描き出すとともに、日本軍の実情が貧弱なものであったことも描き出している。
兵士を戦場に送り込むために用意した輸送船は奴隷船のような船であり、攻撃を受ければ瞬く間に沈没し...</p><div><a class="btn btn-sm btn-outline-primary btn-read-more" href=https://s-show.github.io/posts/2018-02-12/>もっと読む</a></div></div>
</li></ul>
</div>
</section><div class="card component row post-comments" id=post-comments>
<div class=card-header>
<h2 class="card-title my-2 fs-4 text-surface">コメント</h2>
</div>
<div class=card-body><script src=https://utteranc.es/client.js repo=s-show/s-show.github.io issue-term=title label=comment theme=github-light crossorigin=anonymous async></script>
</div>
</div></div>
</div>
</div>
</main><footer class="footer mt-auto py-3 text-center container"><div class="offcanvas offcanvas-bottom h-auto" tabindex=-1 id=offcanvasActionsPanel aria-labelledby=offcanvasActionsPanelLabel>
<div class=offcanvas-header>
<h5 class="offcanvas-title fs-4" id=offcanvasActionsPanelLabel>
<i class="fas fa-fw fa-th-large me-1"></i>
Actions
</h5>
<button type=button class="btn-close ms-auto" data-bs-dismiss=offcanvas data-bs-target=offcanvasActionsPanel aria-label=Close></button>
</div>
<div class="offcanvas-body mt-2"><div class="social-share mb-4 d-flex overflow-auto">
<a class="btn-social-share d-flex flex-column align-items-center me-3" rel="noopener noreferrer" aria-label="Twitter Share Button" target=_blank href="https://twitter.com/intent/tweet?title=AutoHotKey%e3%81%ae%e8%a7%a3%e8%aa%ac%e3%81%a8%e8%87%aa%e5%88%86%e3%81%ae%e8%a8%ad%e5%ae%9a%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6&url=https%3a%2f%2fs-show.github.io%2fposts%2f2019-06-18%2f">
<i class="fab fa-2x fa-fw fa-twitter mb-2"></i> Twitter
</a>
<a class="btn-social-share d-flex flex-column align-items-center me-3" rel="noopener noreferrer" aria-label="Facebook Share Button" target=_blank href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fs-show.github.io%2fposts%2f2019-06-18%2f">
<i class="fab fa-2x fa-fw fa-facebook-f mb-2"></i> Facebook
</a>
</div>
<hr class=mb-4><div class="actions d-flex overflow-auto align-items-center">
<a role=button class="action action-go-back d-flex flex-column align-items-center me-3" href="javascript: window.history.back();">
<span class="action-icon mb-2"><i class="fas fa-2x fa-chevron-circle-down" data-fa-transform=rotate-90></i></span> 戻る
</a>
<a role=button class="action action-reload-page d-flex flex-column align-items-center me-3">
<span class="action-icon mb-2"><i class="fas fa-2x fa-redo-alt"></i></span> 再表示
</a>
<a role=button class="action action-copy-url d-flex flex-column align-items-center me-3">
<span class="action-icon mb-2"><i class="fas fa-2x fa-link"></i></span> URLをコピー
</a>
</div>
</div>
</div>
<nav class="social-links nav justify-content-center mb-2">
<a class="nav-link social-link" href=mailto:kankodori.blog@gmail.com title=Email>
<i class="fas fa-fw fa-2x fa-envelope"></i>
</a>
<a class="nav-link social-link" target=_blank href=https://github.com/s-show/s-show.github.io title=GitHub rel="noopener noreferrer">
<i class="fa-fw fa-2x fab fa-github"></i>
</a>
<a class="nav-link social-link" target=_blank href=https://www.reddit.com/user/s-show title=Reddit rel="noopener noreferrer">
<i class="fa-fw fa-2x fab fa-reddit"></i>
</a>
<a class="nav-link social-link" target=_blank href=https://twitter.com/s_show_0000 title=Twitter rel="noopener noreferrer">
<i class="fa-fw fa-2x fab fa-twitter"></i>
</a>
<a class="nav-link social-link" target=_blank href=https://s-show.github.io/index.xml title=RSS rel="noopener noreferrer">
<i class="fas fa-fw fa-2x fa-rss"></i>
</a>
</nav>
<div class="copyright mb-2">
Copyright © 2021-2022 s-show. All Rights Reserved.
</div>
<div class="powered-by mb-2">
Powered by <a class=text-primary href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> and the <a class=text-primary href=https://github.com/razonyang/hugo-theme-bootstrap target=_blank rel="noopener noreferrer">HBS</a> theme.
</div></footer>
<script data-precache src=https://s-show.github.io/assets/main/bundle.min.a17359faba7faa37b2bdeaa37f63888a1ad10e1bb649a73133d89a61a02804d8.js integrity="sha256-oXNZ+rp/qjeyveqjf2OIihrRDhu2SacxM9iaYaAoBNg=" crossorigin=anonymous defer></script><script data-precache src=https://s-show.github.io/assets/icons/bundle.min.e463af86313483a41647b10fe3f6b7f5155673c4ee5feecfb9927075dbcc99f7.js integrity="sha256-5GOvhjE0g6QWR7EP4/a39RVWc8TuX+7PuZJwddvMmfc=" crossorigin=anonymous defer></script>
<script data-precache src=https://s-show.github.io/assets/viewer/bundle.min.656553c767bb7b8c29a3d0bf77142fe671344d24fe46bc9df13b218f0ebb2f6f.js integrity="sha256-ZWVTx2e7e4wpo9C/dxQv5nE0TST+Rryd8Tshjw67L28=" crossorigin=anonymous defer></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-367F1P4JXZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-367F1P4JXZ',{anonymize_ip:!1})}</script>
</body>
</html>